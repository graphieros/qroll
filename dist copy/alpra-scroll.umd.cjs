(function(o){typeof define=="function"&&define.amd?define(o):o()})(function(){"use strict";var o;(e=>{e.BOTTOM="kodex-bottom",e.BOTTOM_INVISIBLE="kodex-bottom-invisible",e.CHILD="kodex-child",e.CHILDREN_WRAPPER="kodex-children-wrapper",e.CHILD_VISIBLE="kodex-child-visible",e.HIDDEN="kodex-hidden",e.HAS_NAV="kodex-nav",e.PARENT="kodex-parent",e.TOP="kodex-top",e.TRANSITION_1000="kodex-transition-1000",e.TRANSITION_300="kodex-transition-300",e.TRANSITION_400="kodex-transition-400",e.TRANSITION_500="kodex-transition-500",e.TRANSITION_600="kodex-transition-600",e.TRANSITION_700="kodex-transition-700",e.TRANSITION_800="kodex-transition-800",e.TRANSITION_900="kodex-transition-900",e.TRANSITION_Y="kodex-transitionY",e.TOOLTIP_LEFT="kodex-tooltip-left",e.NAV_VERTICAL="kodex-nav-vertical",e.NAV_ELEMENT_WRAPPER="kodex-nav-element-wrapper",e.LOOP="kodex-loop"})(o||(o={}));var s;(e=>{e.DOWN="down",e.LEFT="left",e.RIGHT="right",e.UP="up"})(s||(s={}));var S;(e=>{e.A="a",e.DIV="DIV",e.NAV="nav",e.SPAN="span"})(S||(S={}));var E;(e=>{e.NAV="kodexNav",e.PARENT="kodex-parent"})(E||(E={}));var p;(e=>{e.KEYUP="keyup",e.RESIZE="resize",e.TOUCHEND="touchend",e.TOUCHMOVE="touchmove",e.TOUCHSTART="touchstart",e.WHEEL="wheel",e.HASHCHANGE="hashchange"})(p||(p={}));var h;(e=>{e.ARROW_DOWN="ArrowDown",e.ARROW_LEFT="ArrowLeft",e.ARROW_RIGHT="ArrowRight",e.ARROW_UP="ArrowUp",e.SPACE="Space",e.ENTER="Enter"})(h||(h={}));var y;(e=>{e.BODY="BODY",e.INPUT="INPUT",e.TEXTAREA="TEXTAREA"})(y||(y={}));function ee(e,u){return e.length<u?e:`${e.slice(0,u)}...`}function F(){let e=new Date().getTime(),u=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return"xxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){let I=Math.random()*16;return e>0?(I=(e+I)%16|0,e=Math.floor(e/16)):(I=(u+I)%16|0,u=Math.floor(u/16)),(d==="x"?I:I&3|8).toString(16)})}function te(e){let u=!1;return e.wheelDeltaY?e.wheelDeltaY===e.deltaY*-3&&(u=!0):e.deltaMode===0&&(u=!0),u}function D(e){return document.getElementById(e)}function G(e){return document.querySelector(`[data-slide="${e}"]`)}function ne(e){console.error("Alpra-scroll exception:",{error:e})}function W(e,u){const d=e.findIndex(O=>Number(O.dataset.index)===u);if(u===-1)return e;const I=e.slice(d),T=e.slice(0,d);return[...I,...T]}function ie(e){e.scrollHeight>e.clientHeight&&e.setAttribute("tabindex","0")}function _(e){return document.createElement(e)}function q(e,u){for(u(e),e=e.firstChild;e;)q(e,u),e=e.NextSibling}const X=(e,u={})=>{let d=500;const I=o.PARENT;let T=!1,O=window.innerHeight,H,w,z,U,V,A,Z=!1,re=30,g=Array.from(D(E.PARENT).classList).includes(o.LOOP),m=1;window.onload=()=>{Ne()};function oe(){Ae()}function x(t,n,i=1){t>0?(m>a.length-1&&(m=a.length-1),L(-O*m),m+=1):n<=-O&&(L(n+O*i),m-=1,m<1&&(m=1));const r=Array.from(a).find((c,f)=>f===m-1);setTimeout(()=>{T=!1,k(r.id),M(r.id)},d)}function ae(t){const n=t.code,i=t.target,r=i.scrollHeight>i.clientHeight,c=[y.TEXTAREA,y.INPUT].includes(i.nodeName),f=r&&i.nodeName!==y.BODY;if([c,f].includes(!0))return;const b=l.getBoundingClientRect().y,N={loopDown:[h.ARROW_DOWN,h.SPACE].includes(n)&&g,loopUp:[h.ARROW_UP].includes(n)&&g,noLoopDown:[h.ARROW_DOWN,h.SPACE].includes(n)&&!g&&!T,noLoopUp:[h.ARROW_UP].includes(n)&&!g&&!T};switch(!0){case N.loopDown:R(s.DOWN);break;case N.noLoopDown:T=!0,x(1,b);break;case N.loopUp:R(s.UP);break;case N.noLoopUp:T=!0,x(-1,b);break;default:return}}function le(t){O=t.target.innerHeight}function ce(t){var n;w=((n=t.changedTouches)==null?void 0:n[0])||w}function de(t){const n=t.target.scrollHeight>t.target.clientHeight;if([!Array.from(t.target.classList).includes(o.CHILD)&&n].includes(!0))return;const r=(H==null?void 0:H.clientY)-(w==null?void 0:w.clientY),c=l.getBoundingClientRect().y;if(!g&&!T){T=!0,x(r,c);return}r>0?R(s.DOWN):r<0&&R(s.UP)}function se(t){var n;H=((n=t.changedTouches)==null?void 0:n[0])||H}function ue(t){Z=te(t);const n=t.target.scrollHeight>t.target.clientHeight;if(!Array.from(t.target.classList).includes(o.CHILD)&&n)return;const i=l.getBoundingClientRect().y;if(!g&&!T){T=!0,x(t.deltaY,i);return}if(!Z&&t.deltaY!==-0)if(t.deltaY&&t.deltaY>0){if(t.deltaY<7)return;R(s.DOWN)}else R(s.UP)}const C=[{target:document,trigger:p.KEYUP,method:ae},{target:document,trigger:p.TOUCHEND,method:ce},{target:document,trigger:p.TOUCHMOVE,method:de},{target:document,trigger:p.TOUCHSTART,method:se},{target:document,trigger:p.WHEEL,method:ue},{target:window,trigger:p.HASHCHANGE,method:oe},{target:window,trigger:p.RESIZE,method:le}];C.forEach(t=>{t.target.addEventListener(t.trigger,t.method)}),window.onunload=function(){C.forEach(t=>{t.target.removeEventListener(t.trigger,t.method)})};const l=D(e);if(!l)return ne("parent name not found: "+e);switch(!0){case Array.from(l.classList).includes(o.TRANSITION_300):A=o.TRANSITION_300,d=300;break;case Array.from(l.classList).includes(o.TRANSITION_400):A=o.TRANSITION_400,d=400;break;case Array.from(l.classList).includes(o.TRANSITION_500):A=o.TRANSITION_500,d=500;break;case Array.from(l.classList).includes(o.TRANSITION_600):A=o.TRANSITION_600,d=600;break;case Array.from(l.classList).includes(o.TRANSITION_700):A=o.TRANSITION_700,d=700;break;case Array.from(l.classList).includes(o.TRANSITION_800):A=o.TRANSITION_800,d=800;break;case Array.from(l.classList).includes(o.TRANSITION_900):A=o.TRANSITION_900,d=900;break;case Array.from(l.classList).includes(o.TRANSITION_1000):A=o.TRANSITION_1000,d=1e3;break;default:A=o.TRANSITION_500;break}l.classList.add(I);let a=l.children;for(let t=0;t<a.length;t+=1){const n=F(),i=a[t];i.classList.add(o.CHILD),i.dataset.slide=n,i.setAttribute("id",i.id||`slide-v-${t}`),i.dataset.index=`${t}`,Array.from(i.children).forEach(r=>q(r,ie))}function fe(){if(document.querySelectorAll(`#${E.NAV}`).length){const n=D(E.NAV);document.body.removeChild(n)}if(Array.from(l.classList).includes(o.HAS_NAV)){const n=_(S.NAV);n.setAttribute("id",E.NAV),n.classList.add(o.NAV_VERTICAL),Array.from(a).forEach((i,r)=>{var K;const c=_(S.DIV);c.classList.add(o.NAV_ELEMENT_WRAPPER);const f=_(S.A);f.setAttribute("tabindex","1"),f.dataset.index=i.dataset.index,f.addEventListener("click",()=>Y(r)),f.addEventListener("keyup",P=>{[h.SPACE,h.ENTER].includes(P.key)&&Y(r)});const b=_(S.SPAN);b.innerHTML="●",f.appendChild(b);const N=_(S.DIV);N.classList.add(o.TOOLTIP_LEFT),N.dataset.index=`${r}`;const $=(K=Array.from(a).find(P=>Number(P.dataset.index)===r))==null?void 0:K.querySelectorAll("h1,h2,h3,h4")[0];$?(N.setAttribute("style",`font-family:${getComputedStyle($).fontFamily.split(",")[0]}`),N.innerHTML=ee($.textContent,re)):(N.setAttribute("style","font-family:Helvetica"),N.innerHTML=`${r}`),N.addEventListener("click",()=>Y(r)),[N,f].forEach(P=>c.appendChild(P)),n.appendChild(c)}),document.body.appendChild(n)}}function v(){var n,i;const t=window==null?void 0:window.location;return t!=null&&t.hash?t==null?void 0:t.hash:((n=a==null?void 0:a[0])==null?void 0:n.id)||((i=a==null?void 0:a[1])==null?void 0:i.id)}function j(t,n){var r;const i=(r=G(t))==null?void 0:r.cloneNode(!0);i.dataset.slide=F(),n===s.DOWN?l.appendChild(i):n===s.UP&&l.prepend(i)}function J(t){T&&(clearTimeout(z),z=setTimeout(()=>{l.removeChild(G(t)),T=!1},d))}function Q(t,n,i){i===s.DOWN?(l.classList.add(A),L(-O),clearTimeout(U),U=setTimeout(()=>l.classList.remove(A),d-d*.1),clearTimeout(V),V=setTimeout(()=>L(0),d),J(t),M(n)):i===s.UP&&(l.classList.remove(A),L(-O),clearTimeout(U),U=setTimeout(()=>l.classList.add(A),50),clearTimeout(V),V=setTimeout(()=>L(0),50),J(t),M(n));const r=Array.from(a).find(c=>c.dataset.slide===n);[s.DOWN,s.UP].includes(i)&&setTimeout(()=>k(r.id),600)}function L(t){l.style.transform=`translateY(${t}px)`}function R(t){if(T)return;const n=v().replace("#slide-v-","");B(+n),T=!0;let i=a[0].dataset.slide,r=a[1].dataset.slide,c=a[a.length-1].dataset.slide;t===s.DOWN?(j(i,t),Q(i,r,t)):t===s.UP&&(j(c,t),Q(c,c,t))}function Te(){a=W(Array.from(a),0)}function Y(t){const n=Array.from(a).find(c=>Number(c.dataset.index)===t),i=Number(v().replace("#slide-v-",""))||0,r=l.getBoundingClientRect().y;if(!g){const c=Math.abs(t-i);if(m=i+1,Number(n.id.replace("slide-v-",""))>i)for(let f=0;f<c;f+=1)x(1,r);else for(let f=0;f<c;f+=1)x(-1,r,c);return}if(t===i+1){R(s.DOWN);return}if(t===i-1){R(s.UP);return}Te(),n==null||n.scrollIntoView({behavior:"smooth"}),setTimeout(()=>{location.hash=n.id,k(n.id),B(t)},d)}function B(t){a=W(Array.from(a),t),l.innerHTML="",a.forEach(n=>l.appendChild(n))}function k(t){const n=D(E.NAV);location.hash=t;const i=Array.from(a).find(r=>r.id===t);n&&Array.from(n.getElementsByTagName(S.A)).map(r=>{r.dataset.currentSlide=r.dataset.index===(i==null?void 0:i.dataset.index)})}function Ae(){let t=v().replace("#","");k(t)}function M(t){const n=location.href;location.href=`#${t}`,history.replaceState(null,"",n)}function Ne(){var i;fe();let t=v().replace("#","");const n=(i=Array.from(a).find(r=>r.id===t))==null?void 0:i.dataset.index;g?(a=W(Array.from(a),+n),B(+n),k(t)):(L(-O*Number(n)),k(t),m=+n+1)}};typeof window<"u"&&(window.mainFunc=X),X("kodex-parent",{sectionClass:"kodex-child"})});
